
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Retro Jump'n'Run v5 Deluxe</title>
  <style>
    html, body { margin:0; padding:0; overflow:hidden; background:#111; color:white; font-family:sans-serif; }
    #game { width:100vw; height:100vh; display:block; background:#000; }
    #controls { position:absolute; bottom:10px; left:50%; transform:translateX(-50%); display:flex; gap:10px; }
    .btn { width:60px; height:60px; background:#fff3; color:white; font-size:24px; border-radius:10px; border:none; }
    #status { position:absolute; top:10px; left:10px; font-size:16px; background:#0007; padding:4px 8px; border-radius:5px; }
  </style>
</head>
<body>
  <canvas id="game"></canvas>
  <div id="status">Loading...</div>
  <div id="controls">
    <button id="left" class="btn">◀️</button>
    <button id="jump" class="btn">⏫</button>
    <button id="right" class="btn">▶️</button>
  </div>

  <script>
(() => {
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  const statusEl = document.getElementById('status');

  const keys = new Set();
  const press = k => keys.add(k);
  const release = k => keys.delete(k);

  for (const id of ['left','right','jump']){
    const el = document.getElementById(id);
    el.addEventListener('touchstart', e => { e.preventDefault(); press(id); }, {passive:false});
    el.addEventListener('touchend',   e => { e.preventDefault(); release(id); }, {passive:false});
  }
  window.addEventListener('keydown', e => {
    const k = e.key.toLowerCase();
    if (k === 'arrowleft' || k === 'a') press('left');
    if (k === 'arrowright' || k === 'd') press('right');
    if (k === ' ' || k === 'w' || k === 'arrowup') press('jump');
  });
  window.addEventListener('keyup', e => {
    const k = e.key.toLowerCase();
    if (k === 'arrowleft' || k === 'a') release('left');
    if (k === 'arrowright' || k === 'd') release('right');
    if (k === ' ' || k === 'w' || k === 'arrowup') release('jump');
  });

  const W = 900, H = 500;
  const player = {x:100,y:0,w:32,h:48,vy:0,onGround:false,alive:true};
  const platforms = [
    {x:0, y:H-50, w:2000, h:50},
    {x:200, y:350, w:120, h:20},
    {x:400, y:300, w:120, h:20},
    {x:650, y:250, w:120, h:20},
    {x:900, y:200, w:120, h:20}
  ];
  const gravity = 900;
  let scrollX = 0;
  let last = performance.now();

  function update(dt){
    const speed = 200;
    if (keys.has('right')) player.x += speed * dt;
    if (keys.has('left'))  player.x -= speed * dt;

    player.vy += gravity * dt;
    player.y += player.vy * dt;
    player.onGround = false;

    for (const plat of platforms){
      if (player.x < plat.x+plat.w && player.x+player.w > plat.x &&
          player.y < plat.y+plat.h && player.y+player.h > plat.y){
        if (player.vy > 0 && player.y+player.h - player.vy*dt <= plat.y){
          player.y = plat.y - player.h;
          player.vy = 0;
          player.onGround = true;
        }
      }
    }

    if (keys.has('jump') && player.onGround){
      player.vy = -450;
    }

    const camCenter = scrollX + W/2;
    if (player.x > camCenter) scrollX = player.x - W/2;
    if (player.x < scrollX + 50) scrollX = Math.max(0, player.x - 50);
  }

  function render(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    const scale = Math.min(canvas.width/W, canvas.height/H);
    const offsetX = (canvas.width - W*scale)/2;
    const offsetY = (canvas.height - H*scale)/2;
    ctx.save();
    ctx.translate(offsetX, offsetY);
    ctx.scale(scale, scale);
    ctx.translate(-scrollX, 0);

    ctx.fillStyle = "#87d37c";
    ctx.fillRect(0, H-50, W*2, 50);

    ctx.fillStyle = "#2ecc71";
    for (const plat of platforms){
      ctx.fillRect(plat.x, plat.y, plat.w, plat.h);
    }

    ctx.fillStyle = "#f39c12";
    ctx.fillRect(player.x, player.y, player.w, player.h);

    ctx.restore();
    statusEl.textContent = `X: ${Math.floor(player.x)} Y: ${Math.floor(player.y)}`;
  }

  function loop(now){
    const dt = Math.min(0.033, (now - last)/1000);
    last = now;
    update(dt);
    render();
    requestAnimationFrame(loop);
  }

  function resize(){
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }

  window.addEventListener('resize', resize);
  resize();
  requestAnimationFrame(loop);
})();
  </script>
</body>
</html>
